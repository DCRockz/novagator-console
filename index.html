<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Novagator Developer Console</title>
<meta name="color-scheme" content="light dark"/>
<style>
  :root{--bg:#0b0f19;--panel:#101623;--text:#e7eefb;--muted:#94a3b8;--accent:#5ee1ff;--accent-2:#7c4dff;--ok:#22c55e;--warn:#f59e0b;--err:#ef4444;--mono:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
  @media (prefers-color-scheme:light){:root[data-theme="light"]{--bg:#f7fafc;--panel:#fff;--text:#0b1220;--muted:#475569;--accent:#0066ff;--accent-2:#7c4dff}}
  *{box-sizing:border-box}html,body{height:100%}
  body{margin:0;background:radial-gradient(1200px 600px at 20% -10%,#12203a 0%,transparent 60%),radial-gradient(800px 600px at 100% 0%,#1b2b4a 0%,transparent 55%),var(--bg);color:var(--text);font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;display:flex;justify-content:center}
  .wrap{width:min(1280px,100%);padding:16px;position:relative}
  .wrap:before{content:"";position:absolute;inset:8px;border-radius:18px;border:1px solid color-mix(in oklab,var(--accent),#000 85%);box-shadow:0 0 0 1px color-mix(in oklab,var(--panel),#fff 8%) inset,0 20px 60px rgba(0,0,0,.35);pointer-events:none}
  .wrap:after{content:"";position:absolute;inset:16px;background-image:linear-gradient(transparent 96%,color-mix(in oklab,var(--accent),#000 80%) 96%),linear-gradient(90deg,transparent 96%,color-mix(in oklab,var(--accent),#000 80%) 96%);background-size:22px 22px,22px 22px;opacity:.12;border-radius:12px;pointer-events:none}
  .shell{background:linear-gradient(180deg,color-mix(in oklab,var(--panel) 92%,transparent) 0%,var(--panel) 100%);border:1px solid color-mix(in oklab,var(--panel),#fff 10%);border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.35);padding:12px;display:flex;flex-direction:column;gap:12px;min-height:80vh;position:relative;overflow:hidden}
  .toolbar{display:flex;align-items:center;gap:10px;flex-wrap:wrap;border:1px solid color-mix(in oklab,var(--panel),#fff 12%);padding:8px;border-radius:12px;background:linear-gradient(180deg,color-mix(in oklab,var(--panel) 85%,transparent),color-mix(in oklab,var(--panel) 93%,transparent));box-shadow:0 2px 12px rgba(0,0,0,.25) inset}
  .title{display:flex;align-items:center;gap:10px;font-weight:700;letter-spacing:.3px}.dot{width:10px;height:10px;border-radius:50%}.dot.ok{background:var(--ok)}.dot.warn{background:var(--warn)}.dot.err{background:var(--err)}
  .badge{font:600 12px var(--mono);color:var(--accent);border:1px solid color-mix(in oklab,var(--accent),#000 60%);padding:2px 8px;border-radius:999px}.rec{color:var(--err);border-color:color-mix(in oklab,var(--err),#000 60%);display:none}:root.record .rec{display:inline-block}
  .btn,select{font:600 12px var(--mono);color:var(--text);background:transparent;border:1px solid color-mix(in oklab,var(--muted),#000 50%);padding:6px 10px;border-radius:10px;cursor:pointer;transition:.15s border-color ease}
  .btn:hover{border-color:color-mix(in oklab,var(--accent),#000 50%)}.btn.primary{border-color:color-mix(in oklab,var(--accent-2),#000 40%);color:var(--accent-2)}
  .pill{font:600 12px var(--mono);padding:4px 8px;border-radius:999px;border:1px solid color-mix(in oklab,var(--muted),#000 50%)}
  .grid{display:grid;grid-template-columns:320px 1fr;gap:12px}@media (max-width:980px){.grid{grid-template-columns:1fr}}
  .panel{border:1px solid color-mix(in oklab,var(--panel),#fff 12%);border-radius:12px;background:color-mix(in oklab,var(--panel) 88%,transparent);padding:10px;display:flex;flex-direction:column;gap:10px;animation:rise .5s ease-out both}
  .panel h3{margin:0 0 6px;font-size:13px;color:var(--muted);font-weight:700;letter-spacing:.04em}.cards{display:grid;grid-template-columns:1fr;gap:8px}
  .card{border:1px solid color-mix(in oklab,var(--muted),#000 50%);border-radius:10px;padding:8px;display:flex;justify-content:space-between;gap:8px;align-items:center;font:12px var(--mono);background:linear-gradient(180deg,color-mix(in oklab,var(--panel) 80%,transparent),color-mix(in oklab,var(--panel) 92%,transparent))}
  .card .k{color:var(--muted)}.big{font:700 18px var(--mono)}.ok{color:var(--ok)}.warn{color:var(--warn)}.err{color:var(--err)}
  .console{border:1px solid color-mix(in oklab,var(--panel),#fff 12%);border-radius:12px;padding:10px;display:flex;flex-direction:column;gap:10px;min-height:50vh;background:linear-gradient(180deg,color-mix(in oklab,var(--panel) 88%,transparent),color-mix(in oklab,var(--panel) 96%,transparent));animation:rise .6s .05s ease-out both}
  @keyframes rise{from{transform:translateY(16px);opacity:0}to{transform:none;opacity:1}}
  .screen{flex:1;overflow:auto;padding:8px 6px;scrollbar-gutter:stable both-edges}
  .line{font-family:var(--mono);white-space:pre-wrap;word-break:break-word;line-height:1.45}.line.fade{color:var(--muted)}
  .line .ts{color:var(--muted);margin-right:8px}.line .tag{padding:1px 6px;border-radius:6px;margin-right:6px;font-weight:700}
  .tag.OUT{background:color-mix(in oklab,var(--accent) 30%,transparent);color:var(--accent)}.tag.SYS{background:color-mix(in oklab,var(--accent-2) 30%,transparent);color:var(--accent-2)}.tag.ERR{background:color-mix(in oklab,var(--err) 25%,transparent);color:var(--err)}
  .prompt-row{display:flex;align-items:flex-start;gap:10px}.prompt{font-family:var(--mono);color:var(--muted)}
  .input{flex:1;min-height:28px;outline:0;border:0;background:transparent;color:var(--text);font-family:var(--mono);font-size:14px;caret-color:var(--accent)}
  .input[contenteditable="true"]:empty:before{content:attr(data-placeholder);color:var(--muted)}
  .footer{display:flex;align-items:center;justify-content:space-between;gap:8px;color:var(--muted);font:12px var(--mono)}
  .kbd{border:1px solid color-mix(in oklab,var(--muted),#000 40%);padding:1px 6px;border-radius:6px;margin:0 2px}
  .ticker{position:relative;height:28px;border:1px solid color-mix(in oklab,var(--accent),#000 60%);border-radius:999px;overflow:hidden;background:linear-gradient(180deg,color-mix(in oklab,var(--panel) 85%,transparent),color-mix(in oklab,var(--panel) 95%,transparent));box-shadow:0 0 20px color-mix(in oklab,var(--accent),#000 85%) inset}
  .ticker .track{position:absolute;white-space:nowrap;will-change:transform;left:0;top:0;padding:5px 0;animation:tick 22s linear infinite;font:600 12px var(--mono);color:color-mix(in oklab,var(--accent),#fff 10%)}@keyframes tick{from{transform:translateX(100%)}to{transform:translateX(-100%)}}
  :root.hud .panel{display:none}:root.hud .toolbar .badge:not(.rec){display:none}:root.hud .toolbar select,:root.hud .toolbar #btnClear{display:none}:root.hud .wrap:after{opacity:.07}
  /* Activation overlay (ensures focus + visible CTA even if init paused) */
  .activate{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(0deg,rgba(0,0,0,.35),rgba(0,0,0,.35));backdrop-filter:saturate(120%) blur(1px)}
  .activate .inner{border:1px dashed color-mix(in oklab,var(--accent),#000 50%);padding:18px 22px;border-radius:12px;background:color-mix(in oklab,var(--panel),#000 10%);font:14px var(--mono);display:flex;gap:12px;align-items:center}
  .activate button{font:600 12px var(--mono);color:var(--accent);background:transparent;border:1px solid color-mix(in oklab,var(--accent),#000 50%);padding:6px 10px;border-radius:10px;cursor:pointer}
  .hidden{display:none}
</style>
</head>
<body>
<div class="wrap">
  <div class="shell">
    <div class="toolbar">
      <div class="title"><span class="dot ok" id="led"></span><span>Novagator Cockpit</span><span class="badge rec" id="recBadge">REC</span><span class="badge" id="ver">v1.5.1</span></div>
      <span class="pill" id="statusPill">status: —</span><span class="pill" id="latencyPill">latency: —</span><span class="pill" id="themePill">theme: auto</span>
      <div style="flex:1"></div>
      <select id="profileSel" title="Profile"><option value="dev">dev</option><option value="stage">stage</option><option value="prod">prod</option></select>
      <select id="themeSel" title="Theme"><option value="auto">auto</option><option value="light">light</option><option value="dark">dark</option></select>
      <button class="btn" id="btnPing">Ping</button><button class="btn primary" id="btnDemo">Run Demo</button><button class="btn" id="btnRecord">Record</button><button class="btn" id="btnClear">Clear</button>
    </div>

    <div class="grid">
      <aside class="panel" id="inst">
        <h3>Instruments</h3>
        <div class="cards">
          <div class="card"><span class="k">Profile</span><span id="cardProfile" class="big">dev</span></div>
          <div class="card"><span class="k">API Base</span><span id="cardApi" style="overflow:hidden;text-overflow:ellipsis;max-width:60%"></span></div>
          <div class="card"><span class="k">Status URL</span><span id="cardStatusUrl" style="overflow:hidden;text-overflow:ellipsis;max-width:60%"></span></div>
          <div class="card"><span class="k">Version</span><span id="cardVersion">—</span></div>
          <div class="card"><span class="k">Last Status</span><span id="cardStatus" class="big">—</span></div>
          <div class="card"><span class="k">Latency</span><span id="cardLatency" class="big">—</span></div>
        </div>
      </aside>

      <main class="console" role="region" aria-label="Developer console">
        <section id="screen" class="screen" aria-live="polite"></section>
        <div class="prompt-row"><div class="prompt" aria-hidden="true">➜</div>
          <div id="input" class="input" contenteditable="true" spellcheck="false" role="textbox" aria-label="Console input" data-placeholder="Type a command… (try 'help')"></div>
        </div>
        <div class="footer"><div>Tips: <span class="kbd">↑/↓</span> history · <span class="kbd">Tab</span> autocomplete · <span class="kbd">Ctrl/⌘</span>+<span class="kbd">L</span> clear · <span class="kbd">Shift</span>+<span class="kbd">Enter</span> newline · use <span class="kbd">;</span> to chain</div><div id="themeIndicator">theme: auto</div></div>
      </main>
    </div>

    <div class="ticker" id="ticker" style="margin-top:8px;"><div class="track" id="tickerTrack">NOVAGATOR ◦ READY ◦ Type 'help' or click Run Demo ◦ </div></div>

    <!-- Activation (click if input looks dead) -->
    <div id="activate" class="activate"><div class="inner"><span>Click to activate console</span><button id="btnActivate">Activate</button></div></div>
  </div>
</div>

<div id="toast" class="toast" role="status" aria-live="polite"></div>

<script>
;(() => {
  'use strict';

  // ——— Helpers to always show errors on screen
  const screenEl = () => document.querySelector("#screen");
  const printErr = (m) => {
    const el = document.createElement("div");
    el.className = "line";
    el.innerHTML = `<span class="ts">[${new Date().toLocaleTimeString()}]</span><span class="tag ERR">ERR</span>${String(m)}`;
    (screenEl()||document.body).appendChild(el);
  };
  window.addEventListener("error", e => printErr(e?.message || e));
  window.addEventListener("unhandledrejection", e => printErr((e && e.reason && e.reason.message) || "Promise rejection"));

  // ——— DOM
  const $ = s => document.querySelector(s);
  const screen = $("#screen"), input = $("#input"), toastEl = $("#toast");
  const themeIndicator = $("#themeIndicator"), verEl = $("#ver");
  const led = $("#led"), statusPill = $("#statusPill"), latencyPill = $("#latencyPill"), themePill = $("#themePill");
  const profileSel = $("#profileSel"), themeSel = $("#themeSel");
  const btnPing = $("#btnPing"), btnDemo = $("#btnDemo"), btn
